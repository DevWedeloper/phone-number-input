---
import type { Method } from '../compodoc-zod'

interface Props {
  method: Method
}

const { method } = Astro.props

const deprecatedTag = method.jsdoctags?.find((tag) => tag.deprecated)

const description = method.jsdoctags?.find((tag) => tag.comment)?.comment
---

<section class="mt-6">
  {/* Method name */}
  <h5 class="font-medium text-base">
    {method.name}
    {method.optional && <span class="text-muted-foreground ml-1">(optional)</span>}
  </h5>

  {/* Deprecated */}
  {
    deprecatedTag && (
      <div class="mt-2 rounded-md border border-yellow-400/40 bg-yellow-400/10 p-3 text-sm">
        <strong>Deprecated.</strong> {deprecatedTag.deprecationMessage}
      </div>
    )
  }

  {/* Description */}
  {description && <div class="prose prose-sm max-w-none mt-2" set:html={description} />}

  {/* Parameters */}
  {
    method.args.length > 0 && (
      <div class="mt-4">
        <h6 class="text-sm font-medium mb-2">Parameters</h6>

        <div class="space-y-3">
          {method.args.map((arg) => (
            <div>
              <div class="font-mono text-sm">{arg.name}</div>
              <div class="font-mono text-xs text-muted-foreground">{arg.type}</div>
            </div>
          ))}
        </div>
      </div>
    )
  }

  {/* Returns */}
  {
    method.returnType && method.returnType !== 'void' && (
      <div class="mt-4">
        <h6 class="text-sm font-medium mb-1">Returns</h6>
        <div class="font-mono text-xs">{method.returnType}</div>
      </div>
    )
  }
</section>
